<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"      
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions">

  <p:dialog header="Histograms"            
            showEffect="fade" 
            hideEffect="fade"                
            widgetVar="histogramsdlg"
            minimizable="false"
            maximizable="false"
            resizable="true"
            draggable="true"
            height="800"
            width="1000">  

    <p:outputPanel id="HistogramsDialog">

      <p:dataGrid rendered="#{listManagerController.histoModel != null}"
                  value="#{listManagerController.histoModel}" 
                  var="histo" 
                  columns="3">      

        <p:barChart value="#{histo.chartModel}"
                    title="#{histo.chartModel.title}"                      
                    extender="histogramExtender"
                    zoom="false"
                    showDatatip="true"
                    style="height:200px; width:200px"
                    barPadding="1"
                    barMargin="1"
                    xaxisAngle="-90"
                    animate="true"
                    stacked="true">

          <p:ajax event="itemSelect" 
                  immediate="true" 
                  process="@this"
                  listener="#{listManagerController.itemSelectHistogram}"
                  update=":myform:growl,:myform:HistogramsDialog,:myform:ListContentDialog,:myform:outerTabView:activeListTabView"/>   

        </p:barChart>

      </p:dataGrid>

      <p:dataGrid value="#{listManagerController.selectedListMembers}"
                  var="clm"
                  columns="7">

        <p:panelGrid columns="1">

          <f:facet name="header"> 
            <h:outputText value="#{clm.cmpd.name}"/>
          </f:facet> 

          <h:graphicImage rendered="#{!empty clm.cmpd.parentFragment.cmpdFragmentStructure.smiles}"
                          alt="png-structure-image"
                          width="100" height="100"
                          url='http://localhost:8080/cdk-export/?format=png&amp;structure=#{applicationScopeBean.urlEncode(clm.cmpd.parentFragment.cmpdFragmentStructure.smiles)}'>
          </h:graphicImage> 

          <p:commandLink update=":myform:ListManagerCmpdDetailsDialog" oncomplete="listmanagercmpddetailsdlg.show()" title="View Detail">  
            <h:outputText styleClass="ui-icon ui-icon-search" style="margin:0 auto;" />   
            <f:setPropertyActionListener value="#{clm.cmpd}"   
                                         target="#{listManagerController.selectedCmpd}" />  
          </p:commandLink>  

        </p:panelGrid>
     

      </p:dataGrid>

    </p:outputPanel>

  </p:dialog>

</ui:composition>