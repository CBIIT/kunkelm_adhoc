<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"      
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                template="/webpages/templates/ui.xhtml">

    <ui:define name="content">
        
        <p:panel>
            
            <f:facet name="header">
                <h:outputText value="Kekule Image of Legacy Compound" />
            </f:facet>
            
            <h:graphicImage alt="Kekule Image of Legacy Compound"
                            width="#{sessionController.configurationBean.strcDim}" height="#{sessionController.configurationBean.strcDim}"                                
                            styleClass="unassignedClass"                                                                                        
                            url='/LegacyImageServlet?nsc=#{fragmentsWorkbenchController.cmpd.nsc}'>                                          
            </h:graphicImage>
            
        </p:panel>
        
            

        <p:dataTable id="fragments"
                     resizableColumns="true"
                     tableStyle="width: auto;"
                     editable="true"                      
                     var="frag"
                     value="#{fragmentsWorkbenchController.fragments}"
                     paginator="false" >

            <f:facet name="header">  
                NSC: #{fragmentsWorkbenchController.cmpd.nsc} #{fn:length(fragmentsWorkbenchController.fragments)} Fragments
            </f:facet>

            <p:ajax event="rowEdit" listener="#{fragmentsWorkbenchController.onRowEdit}" update=":datasystemForm:msgs" />
            <p:ajax event="rowEditCancel" listener="#{fragmentsWorkbenchController.onRowCancel}" update=":datasystemForm:msgs" />
            <p:ajax event="cellEdit" listener="#{fragmentsWorkbenchController.onCellEdit}" update=":datasystemForm:msgs" />

            <p:column style="width:32px">
                <p:rowEditor />
            </p:column>

            <p:column headerText="id" sortBy="#{frag.id}">              
                <h:outputText value="#{frag.id}" />
            </p:column>

            <p:column headerText="comment" sortBy="#{frag.comment}">                      
                <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{frag.comment}" /></f:facet>
                    <f:facet name="input"><p:inputText value="#{frag.comment}"/></f:facet>
                </p:cellEditor>  
            </p:column>

            <p:column headerText="molecularFormula" sortBy="#{frag.cmpdFragmentPChem.molecularFormula}">                      
                <h:outputText value="#{frag.cmpdFragmentPChem.molecularFormula}" />
            </p:column>
            
            <p:column headerText="molecularWeight" sortBy="#{frag.cmpdFragmentPChem.molecularWeight}">                      
                <h:outputText value="#{frag.cmpdFragmentPChem.molecularWeight}" />
            </p:column>
            
            
            <p:column headerText="stoichiometry" sortBy="#{frag.stoichiometry}">              
                <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{frag.stoichiometry}" /></f:facet>
                    <f:facet name="input">
                        <h:selectOneMenu value="#{frag.stoichiometry}">
                            <f:selectItem itemValue="3" itemLabel="3"/>
                            <f:selectItem itemValue="2" itemLabel="2"/>
                            <f:selectItem itemValue="1" itemLabel="1"/>
                            <f:selectItem itemValue="0.66" itemLabel="2/3"/>
                            <f:selectItem itemValue="0.5" itemLabel="1/2"/>
                            <f:selectItem itemValue="0.33" itemLabel="1/3"/>
                        </h:selectOneMenu>
                    </f:facet>
                </p:cellEditor>  
            </p:column>

            <p:column headerText="CanSmi Structure">
                <h:graphicImage alt="Chemical Structure of List Anchor"
                                width="#{sessionController.configurationBean.strcDim}" height="#{sessionController.configurationBean.strcDim}"
                                styleClass="fragmentStructure"
                                url='#{sessionController.configurationBean.getSmilesStrcUrl(frag.cmpdFragmentStructure.canSmi, null, frag.id)}'>              
                </h:graphicImage>
            </p:column>

        </p:dataTable>

    </ui:define>

</ui:composition>