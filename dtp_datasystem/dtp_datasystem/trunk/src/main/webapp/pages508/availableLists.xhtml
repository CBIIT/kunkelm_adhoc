<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"      
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                template="/pages508/templates/ui.xhtml">

    <ui:define name="content">
    
    <p:outputPanel id="availableListsPanel">
        
        <p:commandButton value="Update Lists"
                         action="#{listManagerController508.performUpdateAvailableLists()}"/>

        <p:spacer height="10"/>

        <p:dataTable id="availableListsTbl"
                     var="list"
                     value="#{listManagerController508.availableLists}"
                     paginator="true" 
                     rows="10"   
                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                     rowsPerPageTemplate="10,25,50">

            <f:facet name="header">  
                Available Lists With #{fn:length(listManagerController508.availableLists)} Lists
            </f:facet>

            <p:column>

                <p:commandButton value="VIEW"                                             
                                 action="#{listManagerController508.performLoadSelectedList()}"
                                 onstart="bui_loadinglist_block.show();"
                                 oncomplete="bui_loadinglist_block.hide();">      
                    <f:setPropertyActionListener value="#{list}"   
                                                 target="#{listManagerController508.selectedList}"/>  
                </p:commandButton>

                <br/>

                <p:commandButton  disabled="#{list.listOwner != sessionController508.loggedUser || list.shareWith == 'PUBLIC'}"
                                  value="SHARE"
                                  style="background-color: green;"
                                  action="#{listManagerController508.performMakeListPublic()}">      
                    <f:setPropertyActionListener value="#{list}"   
                                                 target="#{listManagerController508.selectedList}"/>
                </p:commandButton>

                <br/>

                <p:commandButton disabled="#{list.listOwner != sessionController508.loggedUser || list.shareWith == 'PUBLIC'}"                
                                 value="DELETE"
                                 action="#{listManagerController508.initiateDeleteList()}"
                                 style="background-color: red;">
                
                    <f:param name="cmpdListIdForDelete" value="#{list.cmpdListId}"/>

                </p:commandButton>

            </p:column>


            <p:column resizable="true" sortBy="#{list.dateCreated}">

                <f:facet name="header">
                    Date Created <br/> CmpdListId
                </f:facet>

                <h:outputText value="#{list.dateCreated}" /> 
                <br/>
                <h:outputText value="#{list.cmpdListId}" />  

            </p:column> 

            <p:column headerText="ListName" resizable="true" sortBy="#{list.listName}">              
                <h:outputText value="#{list.listName}" />                  
            </p:column> 

            <p:column  headerText="List Size" resizable="true" sortBy="#{list.countListMembers}">              
                <h:outputText value="#{list.countListMembers}" />  
            </p:column> 

            <p:column headerText="Owner" resizable="true" sortBy="#{list.listOwner}">              
                <h:outputText value="#{list.listOwner}" />  
            </p:column> 

            <p:column headerText="Share With" resizable="true" sortBy="#{list.shareWith}">              
                <h:outputText value="#{list.shareWith}" />  
            </p:column> 

            <p:column headerText="List Comment" resizable="true">              
                <h:outputText value="#{list.listComment}" />  
            </p:column> 

            <p:column headerText="Anchor Comment" resizable="true">              
                <h:outputText value="#{list.anchorComment}" />  
            </p:column> 

            <p:column headerText="Anchor Structure" resizable="true">   
                <p:panel>
                    <h:graphicImage rendered="#{!empty list.anchorSmiles}"
                                    alt="png-structure-image"
                                    width="200" height="200"
                                    url='/StructureServlet?structureDim=200&amp;smiles=#{applicationScopeBean.urlEncode(list.anchorSmiles)}'>
                    </h:graphicImage> 
                </p:panel>
                <h:outputText value="#{list.anchorSmiles}" />  
            </p:column> 

        </p:dataTable>

    </p:outputPanel>
    
    </ui:define>

</ui:composition>